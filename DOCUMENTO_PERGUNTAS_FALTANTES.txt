================================================================================
          PERGUNTAS PARA COMPLETAR O DOCUMENTO - ICE CASSINO FLOW
                      Documento: ICE_CASSINO_PAYMENT_FLOW.txt
================================================================================

VERSÃO: 1.0
DATA: 02/02/2026
OBJETIVO: Validar lacunas de código e configuração para implementação completa

================================================================================
                    SEÇÃO 1: FASE 1 - DETECÇÃO NO WHATSAPP
================================================================================

PERGUNTA 1.1
Qual é a regex EXATA que detecta valores em Real no WhatsApp?
Precisamos suportar todos estes formatos?
  - [ ] "R$ 150"
  - [ ] "R$ 150,00"
  - [ ] "R$ 1.500,00"
  - [ ] "R$ 1,500.00" (formato US)
  - [ ] "150 reais"
  - [ ] "150brl"
  - [ ] "BRL 150"
  - [ ] Outros? Quais?

Resposta esperada:
  Regex: _______________________________________________
  Formatos suportados: _______________________________________________


PERGUNTA 1.2
Qual é o seletor CSS CORRETO do campo de composição do WhatsApp Web ATUAL?
O documento menciona: 'div[contenteditable="true"][data-tab="10"]'
Isso ainda está válido ou mudou?

Opções conhecidas:
  - [ ] div[contenteditable="true"][data-testid="compose-box-input"]
  - [ ] div[contenteditable="true"][role="textbox"]
  - [ ] div[data-tab="10"]
  - [ ] Outro? _________________________________

Resposta esperada:
  Seletor primário: _______________________________________________
  Seletores fallback (alternativas): _______________________________________________


PERGUNTA 1.3
Qual é a faixa VÁLIDA de valores em Reais que devemos aceitar?
  - Mínimo: R$ _______________
  - Máximo: R$ _______________
  - Validações adicionais: _________________________________________________


================================================================================
                 SEÇÃO 2: FASE 4 - DETECÇÃO DE CREDENCIAIS
================================================================================

PERGUNTA 2.1
Onde exatamente estão armazenadas as credenciais no Ice Casino ATUAL?
O documento menciona localStorage, mas precisa ser mais específico.

Campos de UID:
  - localStorage.uid? _______________
  - localStorage.userId? _______________
  - sessionStorage.uid? _______________
  - window.game_config.uid? _______________
  - window.__INITIAL_STATE__? _______________
  - Outro local? _________________________________________________

Resposta esperada:
  localStorage keys: _______________________________________________
  sessionStorage keys: _______________________________________________
  window global paths: _______________________________________________


PERGUNTA 2.2
Onde estão armazenadas as keys de autenticação no Ice Casino ATUAL?

Campos de KEY:
  - localStorage.token? _______________
  - localStorage.key? _______________
  - sessionStorage.token? _______________
  - window.game_config.token? _______________
  - window.__INITIAL_STATE__? _______________
  - Headers de requisições? _______________
  - Outro local? _________________________________________________

Resposta esperada:
  localStorage keys: _______________________________________________
  sessionStorage keys: _______________________________________________
  window global paths: _______________________________________________


PERGUNTA 2.3
O sign_key (secret para assinatura MD5) está armazenado em algum lugar?
Ou é sempre o padrão '8uhIUHIH323*&8'?

  - [ ] Está em localStorage
  - [ ] Está em sessionStorage
  - [ ] Está em window globals
  - [ ] É sempre o padrão '8uhIUHIH323*&8'
  - [ ] Varia por usuário/sessão? Como descobrir?

Se varia, como descobrir? _______________________________________________


================================================================================
              SEÇÃO 3: FASE 5-6 - CONSTRUÇÃO E ASSINATURA
================================================================================

PERGUNTA 3.1
Qual é a ORDEM EXATA dos parâmetros para construir o payload?
O documento mostra 8 parâmetros, mas pode haver mais?

Parâmetros obrigatórios (liste em ordem):
  1. _______________________________________________
  2. _______________________________________________
  3. _______________________________________________
  4. _______________________________________________
  5. _______________________________________________
  6. _______________________________________________
  7. _______________________________________________
  8. _______________________________________________

Parâmetros opcionais: _______________________________________________


PERGUNTA 3.2
O algoritmo MD5 é realmente: MD5(secret + queryString)?
Ou é: MD5(queryString + secret)?
Ou outra combinação?

  - [ ] MD5(secret + queryString)
  - [ ] MD5(queryString + secret)
  - [ ] MD5(secret) → depois concatena com queryString
  - [ ] Outra? _______________________________________________

Precisamos verificar com um payload real bem-sucedido?
  - [ ] Sim, forneça um exemplo de recarga bem-sucedida
  - [ ] Não, a documentação do dev está correta


PERGUNTA 3.3
A ordem alfabética dos campos para MD5 é SEMPRE respeitada?
Ou há exceções (ex: sign_key não é incluído)?

  - [ ] Sempre ordena alfabeticamente
  - [ ] Há exceções, quais? _______________________________________________
  - [ ] Alguns campos são excluídos? Quais? _______________________________________________


================================================================================
                  SEÇÃO 4: FASE 7 - ENVIO DA REQUISIÇÃO
================================================================================

PERGUNTA 4.1
A injeção de script via chrome.scripting.executeScript funciona com:
  - [ ] Objetos complexos nos args?
  - [ ] Ou precisa serializar tudo como string?

Se precisa serializar, como fazer corretamente?
_______________________________________________


PERGUNTA 4.2
O método de envio é realmente fetch() com credentials: 'include'?
  - [ ] Sim
  - [ ] Não, é XMLHttpRequest
  - [ ] É outra coisa? _______________________________________________

Por quê essa escolha?
_______________________________________________


================================================================================
                  SEÇÃO 5: FASE 8-9 - RESPOSTA E ENVIO
================================================================================

PERGUNTA 5.1
Como o QR Code chega na resposta da API?
  - [ ] Campo "QRcode" com string PIX (000201...)
  - [ ] Campo "QRcode" com URL
  - [ ] Campo "QRcode" com imagem Base64
  - [ ] Múltiplos campos? Quais?

Resposta esperada (exemplo JSON):
_______________________________________________


PERGUNTA 5.2
Qual é o seletor CSS EXATO do botão "Enviar" no WhatsApp Web ATUAL?
O documento menciona múltiplas opções:
  - [ ] button[aria-label="Send"]
  - [ ] button[aria-label="Enviar"]
  - [ ] span[data-icon="send"]?.parentElement
  - [ ] Outro? _______________________________________________

Qual é o seletor PRIMÁRIO que funciona AGORA?
_______________________________________________


PERGUNTA 5.3
Depois de inserir o texto no campo de composição, que EVENTOS precisam ser disparados?
Apenas input e change? Ou mais?

  - [ ] input
  - [ ] change
  - [ ] keyup
  - [ ] keydown
  - [ ] blur
  - [ ] Outros? _______________________________________________


PERGUNTA 5.4
O clickSendButton() precisa de delay antes de clicar?
  - [ ] Não, clicar imediatamente
  - [ ] Sim, qual delay? ___ ms
  - [ ] Depende de quê? _______________________________________________


================================================================================
                 SEÇÃO 6: CONFIGURAÇÃO E DEPENDÊNCIAS
================================================================================

PERGUNTA 6.1
Qual é o package.json CORRETO para esta extensão?
Precisa incluir:
  - crypto-js para MD5?
  - qrcode para gerar QR?
  - jsQR para decodificar QR?
  - Outras dependências?

Arquivo esperado (forneça package.json completo):
_______________________________________________


PERGUNTA 6.2
Qual é o manifest.json v3 CORRETO para esta extensão?
Precisa incluir:
  - [ ] "scripting" permission
  - [ ] "webRequest" permission (não existe em v3!)
  - [ ] content_scripts para WhatsApp?
  - [ ] content_scripts para Ice Casino?
  - [ ] background service_worker?
  - [ ] host_permissions específicas?

Arquivo esperado (forneça manifest.json completo):
_______________________________________________


PERGUNTA 6.3
Há builders/bundlers necessários? (webpack, vite, esbuild, etc)
Se sim, qual é a configuração?
_______________________________________________


================================================================================
                    SEÇÃO 7: TRATAMENTO DE ERROS
================================================================================

PERGUNTA 7.1
Como o código deve reagir se o DOM foi invalidado durante execução?
  - [ ] Retentar a operação?
  - [ ] Reportar erro e parar?
  - [ ] Aguardar reload da página?

Qual é a melhor estratégia?
_______________________________________________


PERGUNTA 7.2
Se a API retorna erro (ex: "error sign"), o código deve:
  - [ ] Retentar com MD5 alternativo?
  - [ ] Solicitar novo token?
  - [ ] Reportar falha ao usuário?
  - [ ] Outra estratégia? _______________________________________________


PERGUNTA 7.3
Se o WhatsApp não estiver ativo, o código deve:
  - [ ] Aguardar até 5 segundos?
  - [ ] Reportar erro imediatamente?
  - [ ] Salvar PIX em clipboard e mostrar toast?
  - [ ] Outra estratégia? _______________________________________________


================================================================================
                      SEÇÃO 8: COMPORTAMENTOS ESPECIAIS
================================================================================

PERGUNTA 8.1
O sistema deve suportar múltiplos duplo-cliques rápidos (fila)?
  - [ ] Sim, processar sequencialmente
  - [ ] Não, ignorar duplicados

Se sim, qual é o tempo máximo entre cliques para considerar duplicado?
___ ms


PERGUNTA 8.2
Quando o PIX é enviado com sucesso, deve:
  - [ ] Mostrar toast "Enviado!"
  - [ ] Limpar o campo de composição?
  - [ ] Fazer algo especial? _______________________________________________


PERGUNTA 8.3
O código deve logar tudo (debug mode) ou apenas erros?
  - [ ] Apenas erros
  - [ ] Debug completo sempre
  - [ ] Debug apenas se extensão estiver em dev mode
  - [ ] Outro? _______________________________________________


================================================================================
                   SEÇÃO 9: PERFORMANCE E TIMING
================================================================================

PERGUNTA 9.1
O documento espera 300-750ms total. Isso é realista?
Ou precisa de mais tempo para:
  - [ ] Detectar credenciais (primeiro acesso)
  - [ ] Injetar script na aba
  - [ ] Processar QR code
  - [ ] Enviar ao WhatsApp

Qual é o timing REAL esperado agora?
_______________________________________________


PERGUNTA 9.2
Há timeout máximo para qualquer operação?
  - [ ] Timeout para envio de requisição: ___ ms
  - [ ] Timeout para resposta da API: ___ ms
  - [ ] Timeout para envio ao WhatsApp: ___ ms


================================================================================
                      SEÇÃO 10: VALIDAÇÕES FINAIS
================================================================================

PERGUNTA 10.1
Existe documentação ou exemplos reais (curl/postman) de:
  - [ ] Requisição bem-sucedida ao /api/v1/user/recharge
  - [ ] Resposta bem-sucedida com QR code
  - [ ] Payload correto já testado
  - [ ] Headers exatos

Se sim, forneça exemplos:
_______________________________________________


PERGUNTA 10.2
O documento precisa de:
  - [ ] Capturas de tela dos seletores CSS
  - [ ] Exemplos de localStorage do Ice Casino
  - [ ] Exemplos de resposta da API
  - [ ] Testes unitários de exemplo
  - [ ] Exemplo de log de sucesso completo

Quais? _______________________________________________


================================================================================
                              RESUMO
================================================================================

Perguntas críticas (responda TODAS):
  ☐ 1.1 - Regex de detecção
  ☐ 1.2 - Seletor WhatsApp compose box
  ☐ 2.1 - Onde estão uid/credenciais
  ☐ 2.2 - Onde estão keys
  ☐ 3.2 - Algoritmo MD5 exato
  ☐ 5.2 - Seletor botão enviar
  ☐ 6.2 - Manifest.json correto

Perguntas importantes (responda a maioria):
  ☐ 3.1 - Ordem dos parâmetros
  ☐ 5.1 - Formato da resposta QR
  ☐ 6.1 - Package.json
  ☐ 10.1 - Exemplos reais testados

================================================================================
                        PRÓXIMOS PASSOS
================================================================================

1. [ ] Imprima este arquivo
2. [ ] Passe para o DEV da equipe
3. [ ] Solicite que responda TODAS as perguntas
4. [ ] Valide com exemplos reais (curl, console logs)
5. [ ] Atualize o documento principal com as respostas
6. [ ] Implemente o código baseado nas respostas

================================================================================
                              FIM
================================================================================
